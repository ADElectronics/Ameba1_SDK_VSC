# Ameba1 SDK + Project Examples (Visual Stusio Code, GCC, JLink)
**! WIP !**
**Всё в начальном состоянии и ещё НЕ доведено до полностью рабочего состояния, возможны детские ошибки или проблемы со сборкой или заливкой прошивки или отладкой.**

Примеры проектов A и Z серий, а так же SDK основаны на оффициальном репозитории [amb1_sdk](https://github.com/ambiot/amb1_sdk) с частично (не использованы исходники wlan) перенесёнными правками из [RTL00_WEB](https://github.com/pvvx/RTL00_WEB) от pvvx, а так же произведен полный пересмотр скриптов сборки, прошивки, отладки и, конечно же, внесены свои правки в SDK.

**Основные отличия**

* Проект исключительно под бесплатные Visual Stusio Code и GCC
* В качестве отладчика используется исключительно Segger JLink v9 и выше
* Папка SDK не захардкодена и её наличие не обязательно рядом с папками проектов (пути к SDK прописываются в проекте)
* Возможность исключать из компиляции не используемые части SDK (офф.примеры, библиотеки и т. п.)
* Возможность выбирать версии FreeRTOS, LwIP
* Обновлён FreeRTOS до v9.0.0
* Обновлён LwIP до v2.1.2 и доступны приложения из него (mDNS и т. д.)

**Файлы настроек проекта**

В корне примеров для обоих серий есть следующие важные файлы сборки проекта:

* Файл **app_settings.mk** - все базовые, глобальные настройки (путь к SDK, версии FreeRTOS, LwIP, компиляция примеров и прочего)
* Файл **app.mk** - флаги компиляции и подключение дальнейших скриптов из sdk
* Папка **.vscode** - настройки VSC, для корректной подсветки кода и перемещения по нему, требуется обновить параметры пути к SDK и версий компонентов в файле **c_cpp_properties.json** , что бы они соответствовали выставленным в app_settings.mk
* Папка **JLink** - скрипты по заливке, отладке прошивки, дополнительные файлы (образ прошивальщика и т. п.)

**Инструменты для работы с проектом**

* [** Visual Studio Code **](https://code.visualstudio.com/) - бесплатный редактор кода.
* [** arm-none-eabi-gcc-xpack **](https://github.com/xpack-dev-tools/arm-none-eabi-gcc-xpack) - 64-битный тулчейн
* [** GNU MCU Eclipse Windows Build Tools **](https://github.com/gnu-mcu-eclipse/windows-build-tools/releases) - инструменты для сборки, Windows порт
* [** Visual Studio Code — написание и отладка прошивок для ARM Cortex-M **](https://adelectronics.ru/2019/04/22/visual-studio-code-%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B8-%D0%BE%D1%82%D0%BB%D0%B0%D0%B4%D0%BA%D0%B0-%D0%BF%D1%80%D0%BE%D1%88%D0%B8%D0%B2%D0%BE%D0%BA-%D0%B4%D0%BB%D1%8F-arm-co/) - подробное описание установки, настройки и начала работы на примере STM32

**Общие не решённые проблемы на данный момент:**

* Не дописаны полноценно все скрипты заливки\отладки прошивки.
* Почистить от тестового мусора и не используемых утилит в SDK.
* Перенести и творчески переработать WEB сервер из RTL00_WEB, что бы основная часть была в SDK, как подключаемый компонент и пользовательская часть была в папке проекта.

**Не решённые проблемы A серии на данный момент:**

* Полноценная заливка в RAM и последующая отладка прошивки без прошивания флешки.
* Использована утилита rtlaimage.py от pvvx для сборки образа, требующая Python, в перспективе переписать всё как было в оригинальном sdk.

**Не решённые проблемы Z серии на данный момент:**

* Сброс точки останова (брейкпоинта) в скрипте GDB загрузчика.
* Сборка с FreeRTOS v9.0.0 завершается ошибкой.
